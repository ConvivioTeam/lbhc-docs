<!DOCTYPE html>




<html lang="en-us">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <title>API Gateway - Hackney & City Directory of Services Documentation</title>
    <link rel="stylesheet" href="/assets/css/just-the-docs.css">
    <link rel="stylesheet" href="/assets/css/styles.css">
    <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script>
    <script type="text/javascript" src="/assets/js/just-the-docs.js"></script>
  
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>

  <div class="page-wrap">
    <div class="side-bar">
      <a href="/" class="site-title fs-6 text-grey-dk-300 lh-tight my-4">Hackney & City Directory of Services Documentation</a>
      <span class="fs-3"><button class="js-main-nav-trigger navigation-list-toggle btn btn-outline" type="button" data-text-toggle="Hide">Menu</button></span>
      <div class="navigation main-nav js-main-nav">
        



<nav>
    <ul class="navigation-list">
        
        
            
        
        
        
            
        
        
        
            
        
        
        
            
            <li class="navigation-list-item active">
                
                <a href="/404.html" class="navigation-list-link"></a>
                
            </li>
            
        
        
        
            
        
        
        
            
        
        
        
            
        
        
        
            
        
        
        
            
        
        
        
            
        
        
        
            
        
        
        
        
        
            
        
        
        
            
        
        
        
            
        
        
        
            
        
        
        
            
        
        
        
            
        
        
        
            
        
        
        
            
        
        
        
            
            <li class="navigation-list-item">
                
                <a href="/about/" class="navigation-list-link">About</a>
                
            </li>
            
        
        
        
            
        
        
        
            
        
        
        
            
        
        
        
            
        
        
        
            
        
        
        
            
        
        
        
            
        
        
        
            
            <li class="navigation-list-item active">
                
                <a href="/microservices" class="navigation-list-link">Microservices</a>
                
                
                <ul class="navigation-list-child-list ">
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                        <li class="navigation-list-item ">
                        
                        <a href="/microservices/systemdesign" class="navigation-list-link">System Design</a>
                        
                        </li>
                    
                    
                    
                    
                    
                        <li class="navigation-list-item  active">
                        
                        <a href="/microservices/apigateway" class="navigation-list-link active">API Gateway</a>
                        
                        </li>
                    
                    
                    
                    
                    
                    
                    
                        <li class="navigation-list-item ">
                        
                        <a href="/microservices/eventstream" class="navigation-list-link">Event Stream</a>
                        
                            
                            <ul class="navigation-list-child-list">
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                                
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                                
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                                
                                
                            
                            </ul>
                        
                        </li>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                        <li class="navigation-list-item ">
                        
                        <a href="/microservices/datastore" class="navigation-list-link">Data Store</a>
                        
                            
                            <ul class="navigation-list-child-list">
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                                
                                
                            
                                
                                
                                
                            
                                
                                
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                                
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                                
                                
                            
                                
                                
                                
                            
                                
                                
                                
                            
                                
                            
                                
                                
                                
                            
                                
                                
                                
                            
                                
                                
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                            </ul>
                        
                        </li>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                        <li class="navigation-list-item ">
                        
                        <a href="/microservices/scraper" class="navigation-list-link">Scraper</a>
                        
                            
                            <ul class="navigation-list-child-list">
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                                
                                
                            
                                
                                
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                                
                                
                            
                                
                                
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                            </ul>
                        
                        </li>
                    
                    
                    
                        <li class="navigation-list-item ">
                        
                        <a href="/microservices/userinterface" class="navigation-list-link">User Interface</a>
                        
                        </li>
                    
                    
                    
                    
                    
                    
                </ul>
                
            </li>
            
        
        
        
            
        
        
        
            
        
        
        
            
        
        
        
            
        
        
        
            
        
        
        
            
            <li class="navigation-list-item">
                
                <a href="/infrastructure" class="navigation-list-link">Infrastructure</a>
                
                
                <ul class="navigation-list-child-list ">
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                        <li class="navigation-list-item ">
                        
                        <a href="/infrastructure/ci-cd-pipeline.html" class="navigation-list-link">CI/CD Pipeline</a>
                        
                        </li>
                    
                    
                    
                        <li class="navigation-list-item ">
                        
                        <a href="/infrastructure/docker-workflow.html" class="navigation-list-link">Docker Workflow</a>
                        
                        </li>
                    
                    
                    
                        <li class="navigation-list-item ">
                        
                        <a href="/infrastructure/future-considerations.html" class="navigation-list-link">Future Considerations</a>
                        
                        </li>
                    
                    
                    
                        <li class="navigation-list-item ">
                        
                        <a href="/infrastructure/secrets-management.html" class="navigation-list-link">Secrets Management</a>
                        
                        </li>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                </ul>
                
            </li>
            
        
        
        
            
        
        
    </ul>
</nav>
      
      </div>
      <footer role="contentinfo" class="site-footer">
        <p class="text-small text-grey-dk-000 mb-0">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p>
      </footer>
    </div>
    <div class="main-content-wrap">
      <div class="page-header">
        <div class="main-content pb-0">
          <div class="search js-search">
            <div class="search-input-wrap">
              <input type="text" class="js-search-input search-input" placeholder="Search Hackney & City Directory of Services Documentation" aria-label="Search Hackney & City Directory of Services Documentation" autocomplete="off">
              <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg>
            </div>
            <div class="js-search-results search-results-wrap"></div>
          </div>
          
            <ul class="list-style-none text-small mt-md-2 pb-4 pb-md-0 js-aux-nav aux-nav">
              
                <li class="d-inline-block my-0"><a href="//github.com/LBHackney-IT/DoS-docs">DoS Docs on Github</a></li>
              
            </ul>
          
        </div>
      </div>
      <div class="main-content">
        
          
          
          
          
          
          
            <nav class="breadcrumb-nav">
              <ol class="breadcrumb-nav-list">
                
                
                <li class="breadcrumb-nav-list-item"><a href="/microservices">Microservices</a></li>
                <li class="breadcrumb-nav-list-item"><span>API Gateway</span></li>
              </ol>
            </nav>
          
        
        <div class="page-content">
          <h1 id="api-gateway-microservice">API Gateway microservice</h1>

<p>The API Gateway microservice provides the interface from the public internet into the Directory of Services system. Its main function is handle RESTful requests from outside the system, pass the request (and associated data, as appropriate) into the event stream, and then consume appropriate response events in the event stream and handle sending that back in the HTTP reponse.</p>

<p>Endpoints are designed to be simple and easy to understand following a standard design pattern:</p>

<ul>
  <li>API Endpoints should be singular e.g. <code class="highlighter-rouge">/provider</code> or <code class="highlighter-rouge">/provider/{id}</code>.</li>
  <li>Each endpoint must support GET, POST and PUT requests.</li>
  <li>When returning data to a request, the response should contain the full data object, including any updates.</li>
</ul>

<h2 id="repository">Repository</h2>

<p>Code for the DoS API Gateway microservice is in the <a href="https://github.com/LBHackney-IT/DoS-api-gateway">https://github.com/LBHackney-IT/DoS-api-gateway</a> repository.</p>

<h2 id="technology-platform">Technology Platform</h2>

<p>The Scraper microservice is built with <a href="https://lumen.laravel.com">Laravel Lumen</a>. It is a small PHP application.</p>

<h2 id="event-streaming">Event Streaming</h2>

<h3 id="event-production">Event Production</h3>

<p>API requests should (generally) result in producing an event — to create, update or retrieve an entity.</p>

<h3 id="event-sourcing">Event Sourcing</h3>

<p>The API Gateway sources events from the event stream for the current complete view of each entity. This is done currently using the <a href="https://laravel.com/docs/5.7/queues#running-the-queue-worker">Laravel queue worker</a>.</p>

<h4 id="caching">Caching</h4>

<p>To accelerate responses, a local cache is included in the API Gateway microservice, using Redis to store the entity views sourced from the event stream. Following a create (POST) or update (PUT) request, the new view of an entity (e.g. a service, or service provider organisation) is returned to the event stream. The API gateway sources these entity views and stores them in a local Redis store.</p>

<p>This may be replaced if a faster method for retrieving events in the event stream can be created than the Laravel queue worker currently used.</p>

<h2 id="api-spec-doc">API Spec doc</h2>

<p>View the spec at <a href="https://app.swaggerhub.com/apis-docs/LBHC/lbh-co_l_directory_of_services_gateway_api/1.0.0">SwaggerHub</a></p>

<p>View the raw spec document at <a href="https://github.com/LBHackney-IT/DoS-api-gateway/blob/master/docs/api/api-gateway.openapi.yml">https://github.com/LBHackney-IT/DoS-api-gateway/blob/master/docs/api/api-gateway.openapi.yml</a></p>


          
        </div>
      </div>
    </div>
  </div>
</html>